{"remainingRequest":"E:\\Project\\HTML\\BIMS_s1\\node_modules\\babel-loader\\lib\\index.js!E:\\Project\\HTML\\BIMS_s1\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\Project\\HTML\\BIMS_s1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Project\\HTML\\BIMS_s1\\src\\view\\bookcenter\\bookadd.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Project\\HTML\\BIMS_s1\\src\\view\\bookcenter\\bookadd.vue","mtime":1664090297821},{"path":"E:\\Project\\HTML\\BIMS_s1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1663239443669},{"path":"E:\\Project\\HTML\\BIMS_s1\\node_modules\\babel-loader\\lib\\index.js","mtime":1663239454289},{"path":"E:\\Project\\HTML\\BIMS_s1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1663239443669},{"path":"E:\\Project\\HTML\\BIMS_s1\\node_modules\\vue-loader\\lib\\index.js","mtime":1663239452314}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.filter\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.match\";\nimport \"core-js/modules/es6.regexp.constructor\";\nimport \"core-js/modules/es6.date.now\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport bookStore from \"./image/bookcenter.js\";\nexport default {\n  mounted: function mounted() {\n    this.book = JSON.parse(JSON.stringify(this.getBook));\n\n    if (this.book.id == 0) {\n      this.book.id = Date.now();\n    } else {\n      this.state = true;\n      this.imgflag = true;\n    }\n\n    this.defaultImg = require(\"../bookcenter/image/subpicture.png\");\n  },\n  computed: {\n    getBookType: function getBookType() {\n      return bookStore.state.bookType;\n    },\n    getBook: function getBook() {\n      return bookStore.state.bookTemp;\n    }\n  },\n  data: function data() {\n    return {\n      defaultImg: '',\n      imgflag: false,\n      state: false,\n      book: {\n        id: 0,\n        name: '',\n        booktype: [],\n        imgurl: require(\"../bookcenter/image/subpicture.png\"),\n        cell: null,\n        price: null,\n        num: null,\n        author: '',\n        publisher: '',\n        introduction: '',\n        publication_year: '',\n        bookstate: 1\n      }\n    };\n  },\n  methods: {\n    cellVerify: function cellVerify() {\n      var h = this.$createElement;\n      var regnum = new RegExp('^[0-9]+(.[0-9]{1,2})?$');\n\n      if (!this.book.cell.match(regnum)) {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '进价不符合规范！')\n        });\n        this.book.cell = '';\n      }\n    },\n    priceVerify: function priceVerify() {\n      var h = this.$createElement;\n\n      if (this.book.cell == '') {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '进价不能为空！')\n        });\n        this.book.price = '';\n        return;\n      }\n\n      var regnum = new RegExp('^[0-9]+(.[0-9]{1,2})?$');\n\n      if (!this.book.price.match(regnum)) {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '售价不符合规范！')\n        });\n        this.book.price = '';\n        return;\n      }\n\n      if (!(parseFloat(this.book.cell) < parseFloat(this.book.price))) {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '售价应该大于进价！')\n        });\n        this.book.price = '';\n        return;\n      }\n    },\n    numVerify: function numVerify() {\n      var h = this.$createElement;\n      var regnum = new RegExp('^([1-9][0-9]*)$');\n\n      if (!this.book.num.match(regnum)) {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '进货数量不符合规范！')\n        });\n        this.book.num = '';\n      }\n    },\n    publication_yearVerify: function publication_yearVerify() {\n      var h = this.$createElement;\n      var regnum = new RegExp('^([1-9][0-9]*)$');\n\n      if (!this.book.publication_year.match(regnum)) {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '出版年份不符合规范！')\n        });\n        this.book.publication_year = '';\n        return;\n      }\n\n      if (this.book.publication_year > new Date().getFullYear()) {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '发售的书不能是未来年份！')\n        });\n        this.book.publication_year = '';\n      }\n    },\n    setImgUrl: function setImgUrl() {\n      var oFReader = new FileReader();\n      var file = document.getElementById('myfile').files[0];\n      oFReader.readAsDataURL(file);\n      var that = this;\n\n      oFReader.onloadend = function (oFRevent) {\n        var src = oFRevent.target.result;\n        document.getElementById('myimg').src = src;\n        that.book.imgurl = src;\n      };\n\n      this.imgflag = true;\n    },\n    clickMyFile: function clickMyFile() {\n      document.getElementById('myfile').click();\n    },\n    delMyFile: function delMyFile() {\n      this.imgflag = false;\n      document.getElementById('myfile').value = '';\n      document.getElementById('myimg').src = this.defaultImg;\n    },\n    tosubmit: function tosubmit() {\n      var _this = this;\n\n      var h = this.$createElement;\n      var imgurl = document.getElementById('myimg').src;\n\n      if (!this.imgflag) {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '没有上传图书封面！')\n        });\n        return;\n      }\n\n      if (this.book.name == '') {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '书籍需要一个名称！')\n        });\n        return;\n      }\n\n      if (this.book.author == '') {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '书籍需要一个作者！')\n        });\n        return;\n      }\n\n      if (this.book.booktype.length == 0) {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '书籍需要一个分类！')\n        });\n        return;\n      }\n\n      if (this.book.cell == null) {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '书籍需要一个进价！')\n        });\n        return;\n      }\n\n      if (this.book.price == null) {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '书籍需要一个售价！')\n        });\n        return;\n      }\n\n      if (this.book.num == null) {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '书籍需要一个数量！')\n        });\n        return;\n      }\n\n      if (this.book.publisher == '') {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '书籍需要一个出版社！')\n        });\n        return;\n      }\n\n      if (this.book.publication_year == null) {\n        this.$notify({\n          title: '警告',\n          message: h('i', {\n            style: 'color: red'\n          }, '书籍需要一个出版年份！')\n        });\n        return;\n      }\n\n      if (this.state) {\n        if (bookStore.state.bookData.filter(function (p) {\n          return p.id != _this.book.id && p.author == _this.book.author && p.name == _this.book.name && p.cell == _this.book.cell && p.price == _this.book.price && p.publisher == _this.book.publisher && p.publication_year == _this.book.publication_year;\n        }).length != 0) {\n          this.$notify({\n            title: '提示',\n            message: h('i', {\n              style: 'color: red'\n            }, '数据重复！')\n          });\n          return;\n        }\n\n        bookStore.commit({\n          type: 'editBook',\n          data: this.book\n        });\n        this.$notify({\n          title: '提示',\n          message: h('i', {\n            style: 'color: red'\n          }, '修改成功！')\n        });\n      } else {\n        if (bookStore.state.bookData.filter(function (p) {\n          return p.author == _this.book.author && p.name == _this.book.name && p.cell == _this.book.cell && p.price == _this.book.price && p.publisher == _this.book.publisher && p.publication_year == _this.book.publication_year;\n        }).length != 0) {\n          this.$notify({\n            title: '提示',\n            message: h('i', {\n              style: 'color: green'\n            }, '数据重复！')\n          });\n          return;\n        }\n\n        bookStore.commit({\n          type: 'addBook',\n          data: this.book\n        });\n        this.$notify({\n          title: '提示',\n          message: h('i', {\n            style: 'color: green'\n          }, '添加成功！')\n        });\n      }\n\n      setTimeout(function () {\n        _this.$emit(\"bookState\", {\n          flag: false\n        });\n      }, 500);\n    }\n  }\n};",{"version":3,"sources":["bookadd.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyEA,OAAA,SAAA;AACA,eAAA;AACA,EAAA,OADA,qBACA;AACA,SAAA,IAAA,GAAA,IAAA,CAAA,KAAA,CAAA,IAAA,CAAA,SAAA,CAAA,KAAA,OAAA,CAAA,CAAA;;AACA,QAAA,KAAA,IAAA,CAAA,EAAA,IAAA,CAAA,EAAA;AACA,WAAA,IAAA,CAAA,EAAA,GAAA,IAAA,CAAA,GAAA,EAAA;AACA,KAFA,MAEA;AACA,WAAA,KAAA,GAAA,IAAA;AACA,WAAA,OAAA,GAAA,IAAA;AACA;;AACA,SAAA,UAAA,GAAA,OAAA,sCAAA;AACA,GAVA;AAWA,EAAA,QAAA,EAAA;AACA,IAAA,WADA,yBACA;AACA,aAAA,SAAA,CAAA,KAAA,CAAA,QAAA;AACA,KAHA;AAIA,IAAA,OAJA,qBAIA;AACA,aAAA,SAAA,CAAA,KAAA,CAAA,QAAA;AACA;AANA,GAXA;AAmBA,EAAA,IAnBA,kBAmBA;AACA,WAAA;AACA,MAAA,UAAA,EAAA,EADA;AAEA,MAAA,OAAA,EAAA,KAFA;AAGA,MAAA,KAAA,EAAA,KAHA;AAIA,MAAA,IAAA,EAAA;AACA,QAAA,EAAA,EAAA,CADA;AAEA,QAAA,IAAA,EAAA,EAFA;AAGA,QAAA,QAAA,EAAA,EAHA;AAIA,QAAA,MAAA,EAAA,OAAA,sCAJA;AAKA,QAAA,IAAA,EAAA,IALA;AAMA,QAAA,KAAA,EAAA,IANA;AAOA,QAAA,GAAA,EAAA,IAPA;AAQA,QAAA,MAAA,EAAA,EARA;AASA,QAAA,SAAA,EAAA,EATA;AAUA,QAAA,YAAA,EAAA,EAVA;AAWA,QAAA,gBAAA,EAAA,EAXA;AAYA,QAAA,SAAA,EAAA;AAZA;AAJA,KAAA;AAmBA,GAvCA;AAwCA,EAAA,OAAA,EAAA;AACA,IAAA,UADA,wBACA;AACA,UAAA,CAAA,GAAA,KAAA,cAAA;AACA,UAAA,MAAA,GAAA,IAAA,MAAA,CAAA,wBAAA,CAAA;;AACA,UAAA,CAAA,KAAA,IAAA,CAAA,IAAA,CAAA,KAAA,CAAA,MAAA,CAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,UAFA;AAFA,SAAA;AAMA,aAAA,IAAA,CAAA,IAAA,GAAA,EAAA;AACA;AAEA,KAdA;AAeA,IAAA,WAfA,yBAeA;AACA,UAAA,CAAA,GAAA,KAAA,cAAA;;AACA,UAAA,KAAA,IAAA,CAAA,IAAA,IAAA,EAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,SAFA;AAFA,SAAA;AAMA,aAAA,IAAA,CAAA,KAAA,GAAA,EAAA;AACA;AACA;;AACA,UAAA,MAAA,GAAA,IAAA,MAAA,CAAA,wBAAA,CAAA;;AACA,UAAA,CAAA,KAAA,IAAA,CAAA,KAAA,CAAA,KAAA,CAAA,MAAA,CAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,UAFA;AAFA,SAAA;AAMA,aAAA,IAAA,CAAA,KAAA,GAAA,EAAA;AACA;AACA;;AACA,UAAA,EAAA,UAAA,CAAA,KAAA,IAAA,CAAA,IAAA,CAAA,GAAA,UAAA,CAAA,KAAA,IAAA,CAAA,KAAA,CAAA,CAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,WAFA;AAFA,SAAA;AAMA,aAAA,IAAA,CAAA,KAAA,GAAA,EAAA;AACA;AACA;AACA,KAhDA;AAiDA,IAAA,SAjDA,uBAiDA;AACA,UAAA,CAAA,GAAA,KAAA,cAAA;AACA,UAAA,MAAA,GAAA,IAAA,MAAA,CAAA,iBAAA,CAAA;;AACA,UAAA,CAAA,KAAA,IAAA,CAAA,GAAA,CAAA,KAAA,CAAA,MAAA,CAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,YAFA;AAFA,SAAA;AAMA,aAAA,IAAA,CAAA,GAAA,GAAA,EAAA;AACA;AACA,KA7DA;AA8DA,IAAA,sBA9DA,oCA8DA;AACA,UAAA,CAAA,GAAA,KAAA,cAAA;AACA,UAAA,MAAA,GAAA,IAAA,MAAA,CAAA,iBAAA,CAAA;;AACA,UAAA,CAAA,KAAA,IAAA,CAAA,gBAAA,CAAA,KAAA,CAAA,MAAA,CAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,YAFA;AAFA,SAAA;AAMA,aAAA,IAAA,CAAA,gBAAA,GAAA,EAAA;AACA;AACA;;AACA,UAAA,KAAA,IAAA,CAAA,gBAAA,GAAA,IAAA,IAAA,GAAA,WAAA,EAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,cAFA;AAFA,SAAA;AAMA,aAAA,IAAA,CAAA,gBAAA,GAAA,EAAA;AACA;AACA,KApFA;AAqFA,IAAA,SArFA,uBAqFA;AACA,UAAA,QAAA,GAAA,IAAA,UAAA,EAAA;AACA,UAAA,IAAA,GAAA,QAAA,CAAA,cAAA,CAAA,QAAA,EAAA,KAAA,CAAA,CAAA,CAAA;AACA,MAAA,QAAA,CAAA,aAAA,CAAA,IAAA;AACA,UAAA,IAAA,GAAA,IAAA;;AACA,MAAA,QAAA,CAAA,SAAA,GAAA,UAAA,QAAA,EAAA;AACA,YAAA,GAAA,GAAA,QAAA,CAAA,MAAA,CAAA,MAAA;AACA,QAAA,QAAA,CAAA,cAAA,CAAA,OAAA,EAAA,GAAA,GAAA,GAAA;AACA,QAAA,IAAA,CAAA,IAAA,CAAA,MAAA,GAAA,GAAA;AACA,OAJA;;AAKA,WAAA,OAAA,GAAA,IAAA;AACA,KAhGA;AAiGA,IAAA,WAjGA,yBAiGA;AACA,MAAA,QAAA,CAAA,cAAA,CAAA,QAAA,EAAA,KAAA;AACA,KAnGA;AAoGA,IAAA,SApGA,uBAoGA;AACA,WAAA,OAAA,GAAA,KAAA;AACA,MAAA,QAAA,CAAA,cAAA,CAAA,QAAA,EAAA,KAAA,GAAA,EAAA;AACA,MAAA,QAAA,CAAA,cAAA,CAAA,OAAA,EAAA,GAAA,GAAA,KAAA,UAAA;AACA,KAxGA;AAyGA,IAAA,QAzGA,sBAyGA;AAAA;;AACA,UAAA,CAAA,GAAA,KAAA,cAAA;AACA,UAAA,MAAA,GAAA,QAAA,CAAA,cAAA,CAAA,OAAA,EAAA,GAAA;;AACA,UAAA,CAAA,KAAA,OAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,WAFA;AAFA,SAAA;AAMA;AACA;;AACA,UAAA,KAAA,IAAA,CAAA,IAAA,IAAA,EAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,WAFA;AAFA,SAAA;AAMA;AACA;;AACA,UAAA,KAAA,IAAA,CAAA,MAAA,IAAA,EAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,WAFA;AAFA,SAAA;AAMA;AACA;;AACA,UAAA,KAAA,IAAA,CAAA,QAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,WAFA;AAFA,SAAA;AAMA;AACA;;AACA,UAAA,KAAA,IAAA,CAAA,IAAA,IAAA,IAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,WAFA;AAFA,SAAA;AAMA;AACA;;AACA,UAAA,KAAA,IAAA,CAAA,KAAA,IAAA,IAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,WAFA;AAFA,SAAA;AAMA;AACA;;AACA,UAAA,KAAA,IAAA,CAAA,GAAA,IAAA,IAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,WAFA;AAFA,SAAA;AAMA;AACA;;AACA,UAAA,KAAA,IAAA,CAAA,SAAA,IAAA,EAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,YAFA;AAFA,SAAA;AAMA;AACA;;AACA,UAAA,KAAA,IAAA,CAAA,gBAAA,IAAA,IAAA,EAAA;AACA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,aAFA;AAFA,SAAA;AAMA;AACA;;AACA,UAAA,KAAA,KAAA,EAAA;AACA,YAAA,SAAA,CAAA,KAAA,CAAA,QAAA,CAAA,MAAA,CAAA,UAAA,CAAA;AAAA,iBACA,CAAA,CAAA,EAAA,IAAA,KAAA,CAAA,IAAA,CAAA,EAAA,IACA,CAAA,CAAA,MAAA,IAAA,KAAA,CAAA,IAAA,CAAA,MADA,IAEA,CAAA,CAAA,IAAA,IAAA,KAAA,CAAA,IAAA,CAAA,IAFA,IAGA,CAAA,CAAA,IAAA,IAAA,KAAA,CAAA,IAAA,CAAA,IAHA,IAIA,CAAA,CAAA,KAAA,IAAA,KAAA,CAAA,IAAA,CAAA,KAJA,IAKA,CAAA,CAAA,SAAA,IAAA,KAAA,CAAA,IAAA,CAAA,SALA,IAMA,CAAA,CAAA,gBAAA,IAAA,KAAA,CAAA,IAAA,CAAA,gBAPA;AAAA,SAAA,EAQA,MARA,IAQA,CARA,EAQA;AACA,eAAA,OAAA,CAAA;AACA,YAAA,KAAA,EAAA,IADA;AAEA,YAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,cAAA,KAAA,EAAA;AADA,aAAA,EAEA,OAFA;AAFA,WAAA;AAMA;AACA;;AACA,QAAA,SAAA,CAAA,MAAA,CAAA;AACA,UAAA,IAAA,EAAA,UADA;AAEA,UAAA,IAAA,EAAA,KAAA;AAFA,SAAA;AAIA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,OAFA;AAFA,SAAA;AAMA,OA5BA,MA4BA;AACA,YAAA,SAAA,CAAA,KAAA,CAAA,QAAA,CAAA,MAAA,CAAA,UAAA,CAAA;AAAA,iBACA,CAAA,CAAA,MAAA,IAAA,KAAA,CAAA,IAAA,CAAA,MAAA,IACA,CAAA,CAAA,IAAA,IAAA,KAAA,CAAA,IAAA,CAAA,IADA,IAEA,CAAA,CAAA,IAAA,IAAA,KAAA,CAAA,IAAA,CAAA,IAFA,IAGA,CAAA,CAAA,KAAA,IAAA,KAAA,CAAA,IAAA,CAAA,KAHA,IAIA,CAAA,CAAA,SAAA,IAAA,KAAA,CAAA,IAAA,CAAA,SAJA,IAKA,CAAA,CAAA,gBAAA,IAAA,KAAA,CAAA,IAAA,CAAA,gBANA;AAAA,SAAA,EAOA,MAPA,IAOA,CAPA,EAOA;AACA,eAAA,OAAA,CAAA;AACA,YAAA,KAAA,EAAA,IADA;AAEA,YAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,cAAA,KAAA,EAAA;AADA,aAAA,EAEA,OAFA;AAFA,WAAA;AAMA;AACA;;AACA,QAAA,SAAA,CAAA,MAAA,CAAA;AACA,UAAA,IAAA,EAAA,SADA;AAEA,UAAA,IAAA,EAAA,KAAA;AAFA,SAAA;AAKA,aAAA,OAAA,CAAA;AACA,UAAA,KAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA,CAAA,CAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;AADA,WAAA,EAEA,OAFA;AAFA,SAAA;AAMA;;AACA,MAAA,UAAA,CAAA,YAAA;AACA,QAAA,KAAA,CAAA,KAAA,CAAA,WAAA,EAAA;AACA,UAAA,IAAA,EAAA;AADA,SAAA;AAGA,OAJA,EAIA,GAJA,CAAA;AAMA;AA5PA;AAxCA,CAAA","sourcesContent":["<template>\r\n\t<div style=\"margin-left: 15px;margin-right: 15px;\">\r\n\t\t<h1>书籍添加</h1>\r\n\t\t<el-row>\r\n\t\t\t<el-col :span=\"3\" style=\"line-height: 40px;\">书名：</el-col>\r\n\t\t\t<el-col :span=\"21\">\r\n\t\t\t\t<el-input v-model=\"book.name\"></el-input>\r\n\t\t\t</el-col>\r\n\t\t</el-row>\r\n\t\t<el-row>\r\n\t\t\t<el-col :span=\"3\" style=\"line-height: 40px;\">作者：</el-col>\r\n\t\t\t<el-col :span=\"21\">\r\n\t\t\t\t<el-input v-model=\"book.author\"></el-input>\r\n\t\t\t</el-col>\r\n\t\t</el-row>\r\n\t\t<el-row>\r\n\t\t\t<el-col :span=\"3\" style=\"line-height: 40px;\">分类：</el-col>\r\n\t\t\t<el-col :span=\"21\">\r\n\t\t\t\t<el-checkbox-group v-model=\"book.booktype\" :max='3'>\r\n\t\t\t\t\t<el-checkbox :label=\"i.name\" v-for=\"(i,n) in getBookType\" ></el-checkbox>\r\n\t\t\t\t</el-checkbox-group>\r\n\t\t\t</el-col>\r\n\t\t</el-row>\r\n\t\t<el-row>\r\n\t\t\t<el-col :span=\"12\">\r\n\t\t\t\t<el-row style=\"\">\r\n\t\t\t\t\t<el-col :span=\"12\" style=\"line-height: 40px;\">进价(单位:元):</el-col>\r\n\t\t\t\t\t<el-col :span=\"12\">\r\n\t\t\t\t\t\t<el-input v-model=\"book.cell\" @change=\"cellVerify\"></el-input>\r\n\t\t\t\t\t</el-col>\r\n\t\t\t\t</el-row>\r\n\t\t\t\t<el-row>\r\n\t\t\t\t\t<el-col :span=\"12\" style=\"line-height: 40px;\">售价(单位:元):</el-col>\r\n\t\t\t\t\t<el-col :span=\"12\">\r\n\t\t\t\t\t\t<el-input v-model=\"book.price\" @change=\"priceVerify\"></el-input>\r\n\t\t\t\t\t</el-col>\r\n\t\t\t\t</el-row>\r\n\t\t\t\t<el-row >\r\n\t\t\t\t\t<el-col :span=\"12\" style=\"line-height: 40px;\">数量(单位:本):</el-col>\r\n\t\t\t\t\t<el-col :span=\"12\">\r\n\t\t\t\t\t\t<el-input v-model=\"book.num\" @change=\"numVerify\"></el-input>\r\n\t\t\t\t\t</el-col>\r\n\t\t\t\t</el-row>\r\n\t\t\t</el-col>\r\n\t\t\t<el-col :span=\"9\" :offset='3'>\r\n\t\t\t\t<img :src=\"book.imgurl\" id=\"myimg\" style=\"width: 100px;height: 150px;\" />\r\n\t\t\t\t<input type=\"file\" id=\"myfile\" style=\"display: none;\" @change=\"setImgUrl\" />\r\n\t\t\t\t<el-row>\r\n\t\t\t\t\t<span @click=\"delMyFile\" class=\"inputbtn\" v-if=\"imgflag\">删除封面</span>\r\n\t\t\t\t\t<span @click=\"clickMyFile\" class=\"inputbtn\" v-else=\"imgflag\">选择封面</span>\r\n\t\t\t\t</el-row>\r\n\t\t\t</el-col>\r\n\t\t</el-row>\r\n\t\t<el-row style=\"margin-top: -30px;\">\r\n\t\t\t<el-col :span=\"4\" style=\"line-height: 40px;\">出版社：</el-col>\r\n\t\t\t<el-col :span=\"8\">\r\n\t\t\t\t<el-input v-model=\"book.publisher\"></el-input>\r\n\t\t\t</el-col>\r\n\t\t\t<el-col :span=\"3\" style=\"line-height: 40px;\" :offset='1'>年份：</el-col>\r\n\t\t\t<el-col :span=\"8\">\r\n\t\t\t\t<el-input v-model=\"book.publication_year\" @change=\"publication_yearVerify\"></el-input>\r\n\t\t\t</el-col>\r\n\t\t</el-row>\r\n\t\t<el-row>\r\n\t\t\t<span>简介：</span>\r\n\t\t\t<el-input type=\"textarea\" v-model=\"book.introduction\"></el-input>\r\n\t\t</el-row>\r\n\t\t<el-button type=\"primary\" style=\"width: 430px;\" @click=\"tosubmit\" v-if=\"state\">确认修改</el-button>\r\n\t\t<el-button type=\"primary\" style=\"width: 430px;\" @click=\"tosubmit\" v-else=\"state\">确认添加</el-button>\r\n\t\r\n\t</div>\r\n</template>\r\n<script>\r\n\timport bookStore from './image/bookcenter.js';\r\n\texport default {\r\n\t\tmounted() {\r\n\t\t\tthis.book = JSON.parse(JSON.stringify(this.getBook))\r\n\t\t\tif (this.book.id == 0) {\r\n\t\t\t\tthis.book.id = Date.now();\r\n\t\t\t} else {\r\n\t\t\t\tthis.state = true;\r\n\t\t\t\tthis.imgflag = true;\r\n\t\t\t}\r\n\t\t\tthis.defaultImg = require('../bookcenter/image/subpicture.png')\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tgetBookType() {\r\n\t\t\t\treturn bookStore.state.bookType;\r\n\t\t\t},\r\n\t\t\tgetBook() {\r\n\t\t\t\treturn bookStore.state.bookTemp;\r\n\t\t\t}\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tdefaultImg: '',\r\n\t\t\t\timgflag: false,\r\n\t\t\t\tstate: false,\r\n\t\t\t\tbook: {\r\n\t\t\t\t\tid: 0,\r\n\t\t\t\t\tname: '',\r\n\t\t\t\t\tbooktype: [],\r\n\t\t\t\t\timgurl: require('../bookcenter/image/subpicture.png'),\r\n\t\t\t\t\tcell: null,\r\n\t\t\t\t\tprice: null,\r\n\t\t\t\t\tnum: null,\r\n\t\t\t\t\tauthor: '',\r\n\t\t\t\t\tpublisher: '',\r\n\t\t\t\t\tintroduction: '',\r\n\t\t\t\t\tpublication_year: '',\r\n\t\t\t\t\tbookstate:1\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tcellVerify() {\r\n\t\t\t\tconst h = this.$createElement;\r\n\t\t\t\tvar regnum = new RegExp('^[0-9]+(.[0-9]{1,2})?$');\r\n\t\t\t\tif (!this.book.cell.match(regnum)) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '进价不符合规范！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.book.cell = ''\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\tpriceVerify() {\r\n\t\t\t\tconst h = this.$createElement;\r\n\t\t\t\tif (this.book.cell == '') {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '进价不能为空！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.book.price = ''\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar regnum = new RegExp('^[0-9]+(.[0-9]{1,2})?$');\r\n\t\t\t\tif (!this.book.price.match(regnum)) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '售价不符合规范！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.book.price = ''\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!(parseFloat(this.book.cell) < parseFloat(this.book.price))) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '售价应该大于进价！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.book.price = ''\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tnumVerify() {\r\n\t\t\t\tconst h = this.$createElement;\r\n\t\t\t\tvar regnum = new RegExp('^([1-9][0-9]*)$');\r\n\t\t\t\tif (!this.book.num.match(regnum)) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '进货数量不符合规范！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.book.num = ''\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tpublication_yearVerify() {\r\n\t\t\t\tconst h = this.$createElement;\r\n\t\t\t\tvar regnum = new RegExp('^([1-9][0-9]*)$');\r\n\t\t\t\tif (!this.book.publication_year.match(regnum)) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '出版年份不符合规范！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.book.publication_year = ''\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.book.publication_year > new Date().getFullYear()) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '发售的书不能是未来年份！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.book.publication_year = ''\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsetImgUrl() {\r\n\t\t\t\tvar oFReader = new FileReader();\r\n\t\t\t\tvar file = document.getElementById('myfile').files[0];\r\n\t\t\t\toFReader.readAsDataURL(file);\r\n\t\t\t\tvar that = this;\r\n\t\t\t\toFReader.onloadend = function(oFRevent) {\r\n\t\t\t\t\tvar src = oFRevent.target.result;\r\n\t\t\t\t\tdocument.getElementById('myimg').src = src;\r\n\t\t\t\t\tthat.book.imgurl = src;\r\n\t\t\t\t}\r\n\t\t\t\tthis.imgflag = true;\r\n\t\t\t},\r\n\t\t\tclickMyFile() {\r\n\t\t\t\tdocument.getElementById('myfile').click()\r\n\t\t\t},\r\n\t\t\tdelMyFile() {\r\n\t\t\t\tthis.imgflag = false;\r\n\t\t\t\tdocument.getElementById('myfile').value = ''\r\n\t\t\t\tdocument.getElementById('myimg').src = this.defaultImg\r\n\t\t\t},\r\n\t\t\ttosubmit() {\r\n\t\t\t\tconst h = this.$createElement;\r\n\t\t\t\tvar imgurl = document.getElementById('myimg').src\r\n\t\t\t\tif (!this.imgflag) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '没有上传图书封面！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.book.name == '') {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '书籍需要一个名称！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.book.author == '') {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '书籍需要一个作者！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.book.booktype.length == 0) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '书籍需要一个分类！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.book.cell == null) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '书籍需要一个进价！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.book.price == null) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '书籍需要一个售价！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.book.num == null) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '书籍需要一个数量！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.book.publisher == '') {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '书籍需要一个出版社！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.book.publication_year == null) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '警告',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '书籍需要一个出版年份！')\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.state) {\r\n\t\t\t\t\tif (bookStore.state.bookData.filter(p =>\r\n\t\t\t\t\t\t\tp.id!=this.book.id&&\r\n\t\t\t\t\t\t\tp.author == this.book.author &&\r\n\t\t\t\t\t\t\tp.name == this.book.name &&\r\n\t\t\t\t\t\t\tp.cell == this.book.cell &&\r\n\t\t\t\t\t\t\tp.price == this.book.price &&\r\n\t\t\t\t\t\t\tp.publisher == this.book.publisher &&\r\n\t\t\t\t\t\t\tp.publication_year == this.book.publication_year\r\n\t\t\t\t\t\t).length != 0) {\r\n\t\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t\t}, '数据重复！')\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbookStore.commit({\r\n\t\t\t\t\t\ttype: 'editBook',\r\n\t\t\t\t\t\tdata: this.book\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: red'\r\n\t\t\t\t\t\t}, '修改成功！')\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (bookStore.state.bookData.filter(p =>\r\n\t\t\t\t\t\t\tp.author == this.book.author &&\r\n\t\t\t\t\t\t\tp.name == this.book.name &&\r\n\t\t\t\t\t\t\tp.cell == this.book.cell &&\r\n\t\t\t\t\t\t\tp.price == this.book.price &&\r\n\t\t\t\t\t\t\tp.publisher == this.book.publisher &&\r\n\t\t\t\t\t\t\tp.publication_year == this.book.publication_year\r\n\t\t\t\t\t\t).length != 0) {\r\n\t\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\t\tstyle: 'color: green'\r\n\t\t\t\t\t\t\t}, '数据重复！')\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbookStore.commit({\r\n\t\t\t\t\t\ttype: 'addBook',\r\n\t\t\t\t\t\tdata: this.book\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\tmessage: h('i', {\r\n\t\t\t\t\t\t\tstyle: 'color: green'\r\n\t\t\t\t\t\t}, '添加成功！')\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.$emit(\"bookState\", {\r\n\t\t\t\t\t\tflag: false\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 500)\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.el-row {\r\n\t\tmargin-bottom: 30px;\r\n\t}\r\n\r\n\t.inputbtn {\r\n\t\tposition: relative;\r\n\t\tdisplay: inline-block;\r\n\t\twidth: 100px;\r\n\t\theight: 30px;\r\n\t\ttext-align: center;\r\n\t\tline-height: 24px;\r\n\t\tvertical-align: center;\r\n\t\tborder: 1px solid #23c6c8;\r\n\t\tbackground-color: #23c6c8;\r\n\t\tcolor: #fff;\r\n\t\tborder-radius: 3px;\r\n\t\t/* margin-left: 20px; */\r\n\t}\r\n\r\n\t.inputbtn:hover {\r\n\t\tborder: 1px solid #23babc;\r\n\t\tborder: 1px solid #23babc;\r\n\t}\r\n\r\n\t.inputbtn input {\r\n\t\tposition: absolute;\r\n\t\tleft: 0;\r\n\t\ttop: 0;\r\n\t\topacity: 0;\r\n\t}\r\n</style>\n"],"sourceRoot":"src/view/bookcenter"}]}