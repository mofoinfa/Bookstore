{"remainingRequest":"D:\\杂项\\作业\\第三阶段实训\\vue前端大作业\\图书馆里系统（vue前端）\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\杂项\\作业\\第三阶段实训\\vue前端大作业\\图书馆里系统（vue前端）\\src\\view\\comment\\Message.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\杂项\\作业\\第三阶段实训\\vue前端大作业\\图书馆里系统（vue前端）\\src\\view\\comment\\Message.vue","mtime":1664027943637},{"path":"D:\\杂项\\作业\\第三阶段实训\\vue前端大作业\\图书馆里系统（vue前端）\\node_modules\\babel-loader\\lib\\index.js","mtime":1663239454289},{"path":"D:\\杂项\\作业\\第三阶段实训\\vue前端大作业\\图书馆里系统（vue前端）\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1663239443669},{"path":"D:\\杂项\\作业\\第三阶段实训\\vue前端大作业\\图书馆里系统（vue前端）\\node_modules\\vue-loader\\lib\\index.js","mtime":1663239452314}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n// 格式化时间函数\nimport {\n\tparseTime\n} from './index.js';\nimport comment from './commentcenter.js';\nexport default {\n\n\tcomputed: {\n\t\tgetmessagelist() {\n\t\t\treturn comment.getters.getMessages;\n\t\t},\n\t\tgetId() {\n\t\t\treturn comment.state.id;\n\t\t},\n\t\tgetName() {\n\t\t\treturn this.$store.state.name;\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tuser: this.$store.state.users.filter(p => p.id == this.$store.state.id)[0],\n\t\t\tid: 0,\n\t\t\tmessage: '',\n\t\t\tpagesize: 3,\n\t\t\tcurrentPage: 1,\n\t\t\tpagemessages: [],\n\t\t\tallmessages: [],\n\t\t}\n\t},\n\tcreated() {\n\t\tcomment.commit({\n\t\t\ttype: 'setId',\n\t\t\tdata: this.$route.query.id\n\t\t})\n\t\tif (this.$store.state.f) {\n\t\t\tcomment.commit({\n\t\t\t\ttype: 'setUser',\n\t\t\t\tdata: this.user\n\t\t\t})\n\t\t}\n\t\tthis.allmessages = this.getmessagelist;\n\t\tthis.id = parseInt(this.getId);\n\t\tthis.doQuery()\n\t},\n\tmethods: {\n\t\t// 模拟后台查询\n\t\tdoQuery() {\n\t\t\tconst start = (this.currentPage - 1) * this.pagesize\n\t\t\tconst end = start + this.pagesize\n\t\t\tfor (var i = start; i < end; i++) {\n\t\t\t\tif (i < this.allmessages.length) {\n\t\t\t\t\tthis.pagemessages.push(this.allmessages[i])\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t// 翻页\n\t\thandleCurrentChange(val) {\n\t\t\tthis.currentPage = val\n\t\t\tthis.pagemessages = []\n\t\t\tthis.doQuery()\n\t\t},\n\t\t// 提交留言\n\t\tsubmitMessage() {\n\t\t\tif (!this.$store.state.f) {\n\t\t\t\tthis.$emit(\"loginstate\", {\n\t\t\t\t\tflag: true\n\t\t\t\t})\n\t\t\t\treturn\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\tif (this.message === '' || this.message.replace(/(^\\s*)|(\\s*$)/g, '') === '') {\n\t\t\t\tthis.$message('留言不能为空')\n\t\t\t\treturn\n\t\t\t}\n\t\t\t//  模拟保存数据\n\t\t\tvar timestamp = Date.parse(new Date())\n\t\t\tthis.allmessages.push({\n\t\t\t\tcreateTime: parseTime(timestamp),\n\t\t\t\tcreateDate: parseTime(timestamp, '{y}-{m}-{d}'),\n\t\t\t\tuser: this.user,\n\t\t\t\tcontent: this.message\n\t\t\t})\n\t\t\tvar message = {\n\t\t\t\tcreateTime: parseTime(timestamp),\n\t\t\t\tcreateDate: parseTime(timestamp, '{y}-{m}-{d}'),\n\t\t\t\tuser: this.user,\n\t\t\t\tcontent: this.message,\n\t\t\t\tid: this.id,\n\t\t\t\tname: this.$route.query.name\n\t\t\t};\n\n\t\t\tcomment.commit({\n\t\t\t\ttype: 'messageAdd',\n\t\t\t\tdata: message\n\t\t\t})\n\n\t\t\tthis.message = ''\n\t\t\t// 翻页到最后一页\n\t\t\tthis.currentPage = Math.ceil(this.allmessages.length / this.pagesize, 0)\n\t\t\tthis.handleCurrentChange(this.currentPage)\n\t\t}\n\t}\n}\n",{"version":3,"sources":["Message.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Message.vue","sourceRoot":"src/view/comment","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<div class=\"el-card-messages\">\r\n\t\t\t<el-input v-model=\"getName\" size=\"mini\" class=\"message-nick-name\" type=\"text\" readonly>\r\n\t\t\t\t<template slot=\"prepend\">昵称：</template>\r\n\t\t\t</el-input>\r\n\t\t\t<el-input slot=\"prepend\" v-model=\"message\" type=\"textarea\" :rows=\"2\" class=\"message-text\"\r\n\t\t\t\tplaceholder=\"输入想评论的内容\" maxlength=\"200\" />\r\n\t\t\t<el-button type=\"info\" round class=\"submit-message\" size=\"mini\" @click=\"submitMessage\">评论</el-button>\r\n\t\t</div>\r\n\t\t<el-card class=\"el-card-d\" shadow=\"always\">\r\n\t\t\t<h3>评论区</h3>\r\n\t\t\t<el-timeline infinite-scroll-disabled=\"disabled\">\r\n\t\t\t\t<div v-if=\"pagemessages.length > 0\">\r\n\t\t\t\t\t<el-timeline-item v-for=\"(item, index) in pagemessages\" :key=\"index\" :timestamp=\"item.createDate\"\r\n\t\t\t\t\t\tplacement=\"top\">\r\n\t\t\t\t\t\t<el-card class=\"el-card-m\">\r\n\t\t\t\t\t\t\t<span class=\"el-card-m-content\">{{ item.content }}</span>\r\n\t\t\t\t\t\t\t<div />\r\n\t\t\t\t\t\t\t<span class=\"el-card-m-nick-name\">{{ item.user.name }} 提交于 {{ item.createTime }}</span>\r\n\t\t\t\t\t\t</el-card>\r\n\t\t\t\t\t</el-timeline-item>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div v-else>\r\n\t\t\t\t\t<el-timeline-item placement=\"top\">\r\n\t\t\t\t\t\t<el-card class=\"el-card-m\">\r\n\t\t\t\t\t\t\t<p class=\"el-card-m-nick-name\"> 没有任何评论</p>\r\n\t\t\t\t\t\t</el-card>\r\n\t\t\t\t\t</el-timeline-item>\r\n\t\t\t\t</div>\r\n\t\t\t</el-timeline>\r\n\t\t\t<el-pagination background :current-page=\"currentPage\" :page-size=\"pagesize\" layout=\"prev, pager, next\"\r\n\t\t\t\t:total=\"allmessages.length\" :hide-on-single-page=\"true\" @current-change=\"handleCurrentChange\" />\r\n\t\t</el-card>\r\n\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\t// 格式化时间函数\r\n\timport {\r\n\t\tparseTime\r\n\t} from './index.js';\r\n\timport comment from './commentcenter.js';\r\n\texport default {\r\n\r\n\t\tcomputed: {\r\n\t\t\tgetmessagelist() {\r\n\t\t\t\treturn comment.getters.getMessages;\r\n\t\t\t},\r\n\t\t\tgetId() {\r\n\t\t\t\treturn comment.state.id;\r\n\t\t\t},\r\n\t\t\tgetName() {\r\n\t\t\t\treturn this.$store.state.name;\r\n\t\t\t}\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tuser: this.$store.state.users.filter(p => p.id == this.$store.state.id)[0],\r\n\t\t\t\tid: 0,\r\n\t\t\t\tmessage: '',\r\n\t\t\t\tpagesize: 3,\r\n\t\t\t\tcurrentPage: 1,\r\n\t\t\t\tpagemessages: [],\r\n\t\t\t\tallmessages: [],\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tcomment.commit({\r\n\t\t\t\ttype: 'setId',\r\n\t\t\t\tdata: this.$route.query.id\r\n\t\t\t})\r\n\t\t\tif (this.$store.state.f) {\r\n\t\t\t\tcomment.commit({\r\n\t\t\t\t\ttype: 'setUser',\r\n\t\t\t\t\tdata: this.user\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tthis.allmessages = this.getmessagelist;\r\n\t\t\tthis.id = parseInt(this.getId);\r\n\t\t\tthis.doQuery()\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 模拟后台查询\r\n\t\t\tdoQuery() {\r\n\t\t\t\tconst start = (this.currentPage - 1) * this.pagesize\r\n\t\t\t\tconst end = start + this.pagesize\r\n\t\t\t\tfor (var i = start; i < end; i++) {\r\n\t\t\t\t\tif (i < this.allmessages.length) {\r\n\t\t\t\t\t\tthis.pagemessages.push(this.allmessages[i])\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 翻页\r\n\t\t\thandleCurrentChange(val) {\r\n\t\t\t\tthis.currentPage = val\r\n\t\t\t\tthis.pagemessages = []\r\n\t\t\t\tthis.doQuery()\r\n\t\t\t},\r\n\t\t\t// 提交留言\r\n\t\t\tsubmitMessage() {\r\n\t\t\t\tif (!this.$store.state.f) {\r\n\t\t\t\t\tthis.$emit(\"loginstate\", {\r\n\t\t\t\t\t\tflag: true\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tif (this.message === '' || this.message.replace(/(^\\s*)|(\\s*$)/g, '') === '') {\r\n\t\t\t\t\tthis.$message('留言不能为空')\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t//  模拟保存数据\r\n\t\t\t\tvar timestamp = Date.parse(new Date())\r\n\t\t\t\tthis.allmessages.push({\r\n\t\t\t\t\tcreateTime: parseTime(timestamp),\r\n\t\t\t\t\tcreateDate: parseTime(timestamp, '{y}-{m}-{d}'),\r\n\t\t\t\t\tuser: this.user,\r\n\t\t\t\t\tcontent: this.message\r\n\t\t\t\t})\r\n\t\t\t\tvar message = {\r\n\t\t\t\t\tcreateTime: parseTime(timestamp),\r\n\t\t\t\t\tcreateDate: parseTime(timestamp, '{y}-{m}-{d}'),\r\n\t\t\t\t\tuser: this.user,\r\n\t\t\t\t\tcontent: this.message,\r\n\t\t\t\t\tid: this.id,\r\n\t\t\t\t\tname: this.$route.query.name\r\n\t\t\t\t};\r\n\r\n\t\t\t\tcomment.commit({\r\n\t\t\t\t\ttype: 'messageAdd',\r\n\t\t\t\t\tdata: message\r\n\t\t\t\t})\r\n\r\n\t\t\t\tthis.message = ''\r\n\t\t\t\t// 翻页到最后一页\r\n\t\t\t\tthis.currentPage = Math.ceil(this.allmessages.length / this.pagesize, 0)\r\n\t\t\t\tthis.handleCurrentChange(this.currentPage)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t.el-input__inner {\r\n\t\tfont-family: '楷体';\r\n\t}\r\n\r\n\tbody {\r\n\t\tfont-family: \"楷体\";\r\n\t}\r\n\r\n\t.el-card-d {\r\n\t\tfloat: left;\r\n\t\tmargin-top: 20px;\r\n\t\twidth: 100%;\r\n\t\tmax-height: 750px;\r\n\t\tbackground: #EEEEEE;\r\n\t}\r\n\r\n\t.el-card-m {\r\n\t\theight: 120px;\r\n\t\tfont-family: \"楷体\";\r\n\t}\r\n\r\n\t.el-card-m-content {\r\n\t\tdisplay: block;\r\n\t\tfont-weight: bold;\r\n\r\n\t}\r\n\r\n\t.el-card-m-nick-name {\r\n\t\tdisplay: block;\r\n\t\tfont-size: x-small;\r\n\t\tmargin-top: 15px;\r\n\t\tcolor: gray;\r\n\t\tfont-size: 15px;\r\n\t\tposition: absolute;\r\n\t\tbottom: 15px;\r\n\t\tfont-size: 17PX;\r\n\t\tline-height: 50px;\r\n\t}\r\n\r\n\t.el-card-messages {\r\n\t\tfloat: left;\r\n\t\tmargin-top: 20px;\r\n\t\twidth: 100%;\r\n\t\tfont-family: \"楷体\";\r\n\t}\r\n\r\n\t.message-nick-name {\r\n\t\twidth: 100%;\r\n\t\tfont-family: \"楷体\";\r\n\t\tmargin-top: 10px;\r\n\t\tfont-size: 14PX;\r\n\t}\r\n\r\n\t.message-text {\r\n\t\tmargin-top: 10px;\r\n\t\tdisplay: block;\r\n\t\twidth: 80%;\r\n\t\toutline-style: none;\r\n\t\tborder: 1px solid #c0c4cc;\r\n\t\tborder-radius: 5px;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tpadding: 10px 15px;\r\n\t\tbox-sizing: border-box;\r\n\t\tfont-family: \"楷体\";\r\n\t\tpadding-right: 120px;\r\n\t\t/* padding-bottom: 50px; */\r\n\t}\r\n\r\n\t.submit-message {\r\n\t\twidth: 100px;\r\n\t\tbackground: antiquewhite;\r\n\t\tcolor: cadetblue;\r\n\t\ttext-align: center;\r\n\t\tletter-spacing: 30px;\r\n\t\tfont-family: \"楷体\";\r\n\t\tfont-size: 20px;\r\n\t\tline-height: 40px;\r\n\t\tmargin-left: 890px;\r\n\t\tmargin-top: -500px;\r\n\t\tpadding-bottom: 0px;\r\n\t\ttransform: translateY(-40px);\r\n\t}\r\n\r\n\t.el-card-messages {\r\n\t\tborder-top: 2px solid #D4D0AB;\r\n\t\tborder-bottom: 1px solid gray;\r\n\t\tpadding-bottom: 10px;\r\n\t}\r\n</style>\n"]}]}