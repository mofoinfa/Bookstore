{"remainingRequest":"D:\\杂项\\作业\\第三阶段实训\\vue前端大作业\\图书馆里系统（vue前端）\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\杂项\\作业\\第三阶段实训\\vue前端大作业\\图书馆里系统（vue前端）\\src\\view\\bookcenter\\shopcar.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\杂项\\作业\\第三阶段实训\\vue前端大作业\\图书馆里系统（vue前端）\\src\\view\\bookcenter\\shopcar.vue","mtime":1664087578398},{"path":"D:\\杂项\\作业\\第三阶段实训\\vue前端大作业\\图书馆里系统（vue前端）\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1663239443669},{"path":"D:\\杂项\\作业\\第三阶段实训\\vue前端大作业\\图书馆里系统（vue前端）\\node_modules\\babel-loader\\lib\\index.js","mtime":1663239454289},{"path":"D:\\杂项\\作业\\第三阶段实训\\vue前端大作业\\图书馆里系统（vue前端）\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1663239443669},{"path":"D:\\杂项\\作业\\第三阶段实训\\vue前端大作业\\图书馆里系统（vue前端）\\node_modules\\vue-loader\\lib\\index.js","mtime":1663239452314}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport shop from '../../config/shopingcenter/shopcenter.js';\nimport book from './image/bookcenter.js'\nimport bill from '../../config/billcenter/billcenter.js'\n// 格式化日对象\nconst getNowDate = () => {\n\tvar date = new Date();\n\tvar sign2 = \":\";\n\tvar year = date.getFullYear() // 年\n\tvar month = date.getMonth() + 1; // 月\n\tvar day = date.getDate(); // 日\n\tvar hour = date.getHours(); // 时\n\tvar minutes = date.getMinutes(); // 分\n\tvar seconds = date.getSeconds() //秒\n\tvar weekArr = ['星期一', '星期二', '星期三', '星期四', '星期五', '星期六', '星期天'];\n\tvar week = weekArr[date.getDay()];\n\t// 给一位数的数据前面加 “0”\n\tif (month >= 1 && month <= 9) {\n\t\tmonth = \"0\" + month;\n\t}\n\tif (day >= 0 && day <= 9) {\n\t\tday = \"0\" + day;\n\t}\n\tif (hour >= 0 && hour <= 9) {\n\t\thour = \"0\" + hour;\n\t}\n\tif (minutes >= 0 && minutes <= 9) {\n\t\tminutes = \"0\" + minutes;\n\t}\n\tif (seconds >= 0 && seconds <= 9) {\n\t\tseconds = \"0\" + seconds;\n\t}\n\treturn year + \"-\" + month + \"-\" + day + \" \" + hour + sign2 + minutes + sign2 + seconds;\n}\n\nexport default {\n\tcreated() {\n\t\tif (!this.$store.state.f) {\n\t\t\tthis.$emit(\"loginstate\", {\n\t\t\t\tflag: true\n\t\t\t})\n\t\t\tthis.$router.push('/')\n\t\t}\n\t\t// 获取用户id\n\t\tshop.commit({\n\t\t\ttype: \"setBid\",\n\t\t\tdata: this.$store.state.id\n\t\t})\n\t},\n\tcomputed: {\n\t\tshoplist() {\n\t\t\treturn shop.getters.getMyShopList;\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tcost: 0,\n\t\t\tnum: 0,\n\t\t\tmultipleSelection: [],\n\t\t}\n\t},\n\tfilters: {\n\t\tgetnum(data) {\n\t\t\treturn book.state.bookData.filter(p => p.id == data)[0].num;\n\t\t}\n\t},\n\tmethods: {\n\t\ttoggleSelection(rows) {\n\t\t\tif (rows) {\n\t\t\t\trows.forEach(row => {\n\t\t\t\t\tthis.$refs.multipleTable.toggleRowSelection(row);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.$refs.multipleTable.clearSelection();\n\t\t\t}\n\t\t},\n\t\tchangeCost() {\n\t\t\tvar cost = 0;\n\t\t\tvar num = 0;\n\t\t\tthis.multipleSelection.map((item, i) => {\n\t\t\t\tcost += item.book.price * item.num;\n\t\t\t\tnum += item.num;\n\t\t\t})\n\t\t\tthis.num = num;\n\t\t\tthis.cost = cost;\n\t\t},\n\n\t\thandleSelectionChange(val) {\n\t\t\tthis.multipleSelection = val;\n\t\t\tthis.changeCost();\n\t\t},\n\t\thandleChange(item) {\n\t\t\tif (item.num == 0) {\n\t\t\t\tshop.commit({\n\t\t\t\t\ttype: 'del',\n\t\t\t\t\tdata: item\n\t\t\t\t})\n\t\t\t}\n\t\t\tthis.changeCost();\n\t\t},\n\t\tgocost() {\n\t\t\tif (this.cost == 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// 判断货源是否充足\n\t\t\tfor (var i = 0; i < this.multipleSelection.length; i++) {\n\t\t\t\tif (book.state.bookData.\n\t\t\t\tfilter(p => p.id == this.multipleSelection[i].book.id && !(p.num < this.multipleSelection[i].num )).length <1) {\n\t\t\t\t\tconsole.log(this.multipleSelection[i].book.name,'库存不足！')\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// 生成订单信息\n\t\t\tvar temp = {\n\t\t\t\tuid: this.$store.state.id,\n\t\t\t\tcreate_time: getNowDate(),\n\t\t\t\tid: Date.now(),\n\t\t\t\tstatus: '1',\n\t\t\t\ttotal_payment: this.cost,\n\t\t\t\tlist: this.multipleSelection,\n\t\t\t\tstart: 0,\n\t\t\t\tpoint: 0,\n\t\t\t}\n\n\t\t\t// 删除购物车选中的信息,书的数量\n\t\t\tfor (var i = 0; i < this.multipleSelection.length; i++) {\n\t\t\t\tshop.commit({\n\t\t\t\t\ttype: 'del',\n\t\t\t\t\tdata: this.multipleSelection[i]\n\t\t\t\t})\n\t\t\t\tbook.commit({\n\t\t\t\t\ttype: 'editBookNum',\n\t\t\t\t\tdata: this.multipleSelection[i]\n\t\t\t\t})\n\t\t\t}\n\t\t\t// 插入订单\n\t\t\tbill.commit({\n\t\t\t\ttype: 'insertBillList',\n\t\t\t\tdata: temp\n\t\t\t})\n\t\t\tthis.$notify({\n\t\t\t\ttitle: '订单消息',\n\t\t\t\tmessage: '订单添加成功，请立即前往订单记录页面支付订单',\n\t\t\t\ttype: 'success'\n\t\t\t});\n\t\t\tthis.$router.push('blog')\n\t\t}\n\t}\n}\n",{"version":3,"sources":["shopcar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"shopcar.vue","sourceRoot":"src/view/bookcenter","sourcesContent":["<template>\r\n\t<div style=\"text-align: center;\">\r\n\t\t<div style=\"width: 850px;margin-left: 300px;height: 600px;margin-top: 30px;\">\r\n\t\t\t<el-table ref=\"multipleTable\" :data=\"shoplist\" tooltip-effect=\"dark\" style=\"width: 100%;border-top: 1px solid #EBEEF5\" height=\"550\"\r\n\t\t\t\t@selection-change=\"handleSelectionChange\">\r\n\t\t\t\t<el-table-column type=\"selection\" width=\"50\">\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column type=\"index\" label=\"序号\" width=\"50\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"book.name\" label=\"书名\" width=\"140\"></el-table-column>\r\n\t\t\t\t<el-table-column label=\"封面\" width=\"180\">\r\n\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t<el-popover placement=\"top-start\" title=\"\" trigger=\"hover\">\r\n\t\t\t\t\t\t\t<img :src=\"scope.row.book.imgurl\" alt=\"\" style=\"width: 180px;height: 200px\">\r\n\t\t\t\t\t\t\t<img slot=\"reference\" :src=\"scope.row.book.imgurl\" style=\"width: 90px;height: 106px\">\r\n\t\t\t\t\t\t</el-popover>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column prop=\"book.price\" label=\"单价\" width=\"80\">\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column prop=\"num\" label=\"数量\" width=\"200\">\r\n\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t<el-input-number v-model=\"scope.row.num\" @change=\"handleChange(scope.row)\" :min=\"0\"\r\n\t\t\t\t\t\t\t:max=\"scope.row.book.id | getnum\"></el-input-number>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column prop=\"num\" label=\"总价\" width=\"150\">\r\n\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t{{scope.row.book.price*scope.row.num}}\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t</el-table>\r\n\t\t\t<div class=\"float-bar\" style=\"background-color:beige\">\r\n\t\t\t\t<div style=\"width:1190px;position:static;\">\r\n\t\t\t\t\t<div class=\"float-bar-wrapper\">\r\n\t\t\t\t\t\t<div class=\"float-bar-right\">\r\n\t\t\t\t\t\t\t<div class=\"amount_items\">\r\n\t\t\t\t\t\t\t\t<span>已选商品</span>\r\n\t\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\t\tstyle=\"color:#f40;float:left;font-weight:700;font-style:normal;font-size:28px\">{{num}}</i>\r\n\t\t\t\t\t\t\t\t<span>件</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"price_sum\">\r\n\t\t\t\t\t\t\t\t<span class=\"total\">合计:</span>\r\n\t\t\t\t\t\t\t\t<strong class=\"price\">\r\n\t\t\t\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"font-weight:700;font-size:24px;padding:0 3px;color:#f40;font-style: normal;\">\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"total_symbol\">￥{{cost}}</span>\r\n\t\t\t\t\t\t\t\t\t</i>\r\n\t\t\t\t\t\t\t\t</strong>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<button class=\"sub-button\" @click=\"gocost\">结 算</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport shop from '../../config/shopingcenter/shopcenter.js';\r\n\timport book from './image/bookcenter.js'\r\n\timport bill from '../../config/billcenter/billcenter.js'\r\n\t// 格式化日对象\r\n\tconst getNowDate = () => {\r\n\t\tvar date = new Date();\r\n\t\tvar sign2 = \":\";\r\n\t\tvar year = date.getFullYear() // 年\r\n\t\tvar month = date.getMonth() + 1; // 月\r\n\t\tvar day = date.getDate(); // 日\r\n\t\tvar hour = date.getHours(); // 时\r\n\t\tvar minutes = date.getMinutes(); // 分\r\n\t\tvar seconds = date.getSeconds() //秒\r\n\t\tvar weekArr = ['星期一', '星期二', '星期三', '星期四', '星期五', '星期六', '星期天'];\r\n\t\tvar week = weekArr[date.getDay()];\r\n\t\t// 给一位数的数据前面加 “0”\r\n\t\tif (month >= 1 && month <= 9) {\r\n\t\t\tmonth = \"0\" + month;\r\n\t\t}\r\n\t\tif (day >= 0 && day <= 9) {\r\n\t\t\tday = \"0\" + day;\r\n\t\t}\r\n\t\tif (hour >= 0 && hour <= 9) {\r\n\t\t\thour = \"0\" + hour;\r\n\t\t}\r\n\t\tif (minutes >= 0 && minutes <= 9) {\r\n\t\t\tminutes = \"0\" + minutes;\r\n\t\t}\r\n\t\tif (seconds >= 0 && seconds <= 9) {\r\n\t\t\tseconds = \"0\" + seconds;\r\n\t\t}\r\n\t\treturn year + \"-\" + month + \"-\" + day + \" \" + hour + sign2 + minutes + sign2 + seconds;\r\n\t}\r\n\r\n\texport default {\r\n\t\tcreated() {\r\n\t\t\tif (!this.$store.state.f) {\r\n\t\t\t\tthis.$emit(\"loginstate\", {\r\n\t\t\t\t\tflag: true\r\n\t\t\t\t})\r\n\t\t\t\tthis.$router.push('/')\r\n\t\t\t}\r\n\t\t\t// 获取用户id\r\n\t\t\tshop.commit({\r\n\t\t\t\ttype: \"setBid\",\r\n\t\t\t\tdata: this.$store.state.id\r\n\t\t\t})\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tshoplist() {\r\n\t\t\t\treturn shop.getters.getMyShopList;\r\n\t\t\t},\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tcost: 0,\r\n\t\t\t\tnum: 0,\r\n\t\t\t\tmultipleSelection: [],\r\n\t\t\t}\r\n\t\t},\r\n\t\tfilters: {\r\n\t\t\tgetnum(data) {\r\n\t\t\t\treturn book.state.bookData.filter(p => p.id == data)[0].num;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\ttoggleSelection(rows) {\r\n\t\t\t\tif (rows) {\r\n\t\t\t\t\trows.forEach(row => {\r\n\t\t\t\t\t\tthis.$refs.multipleTable.toggleRowSelection(row);\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$refs.multipleTable.clearSelection();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchangeCost() {\r\n\t\t\t\tvar cost = 0;\r\n\t\t\t\tvar num = 0;\r\n\t\t\t\tthis.multipleSelection.map((item, i) => {\r\n\t\t\t\t\tcost += item.book.price * item.num;\r\n\t\t\t\t\tnum += item.num;\r\n\t\t\t\t})\r\n\t\t\t\tthis.num = num;\r\n\t\t\t\tthis.cost = cost;\r\n\t\t\t},\r\n\r\n\t\t\thandleSelectionChange(val) {\r\n\t\t\t\tthis.multipleSelection = val;\r\n\t\t\t\tthis.changeCost();\r\n\t\t\t},\r\n\t\t\thandleChange(item) {\r\n\t\t\t\tif (item.num == 0) {\r\n\t\t\t\t\tshop.commit({\r\n\t\t\t\t\t\ttype: 'del',\r\n\t\t\t\t\t\tdata: item\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tthis.changeCost();\r\n\t\t\t},\r\n\t\t\tgocost() {\r\n\t\t\t\tif (this.cost == 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// 判断货源是否充足\r\n\t\t\t\tfor (var i = 0; i < this.multipleSelection.length; i++) {\r\n\t\t\t\t\tif (book.state.bookData.\r\n\t\t\t\t\tfilter(p => p.id == this.multipleSelection[i].book.id && !(p.num < this.multipleSelection[i].num )).length <1) {\r\n\t\t\t\t\t\tconsole.log(this.multipleSelection[i].book.name,'库存不足！')\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// 生成订单信息\r\n\t\t\t\tvar temp = {\r\n\t\t\t\t\tuid: this.$store.state.id,\r\n\t\t\t\t\tcreate_time: getNowDate(),\r\n\t\t\t\t\tid: Date.now(),\r\n\t\t\t\t\tstatus: '1',\r\n\t\t\t\t\ttotal_payment: this.cost,\r\n\t\t\t\t\tlist: this.multipleSelection,\r\n\t\t\t\t\tstart: 0,\r\n\t\t\t\t\tpoint: 0,\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 删除购物车选中的信息,书的数量\r\n\t\t\t\tfor (var i = 0; i < this.multipleSelection.length; i++) {\r\n\t\t\t\t\tshop.commit({\r\n\t\t\t\t\t\ttype: 'del',\r\n\t\t\t\t\t\tdata: this.multipleSelection[i]\r\n\t\t\t\t\t})\r\n\t\t\t\t\tbook.commit({\r\n\t\t\t\t\t\ttype: 'editBookNum',\r\n\t\t\t\t\t\tdata: this.multipleSelection[i]\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\t// 插入订单\r\n\t\t\t\tbill.commit({\r\n\t\t\t\t\ttype: 'insertBillList',\r\n\t\t\t\t\tdata: temp\r\n\t\t\t\t})\r\n\t\t\t\tthis.$notify({\r\n\t\t\t\t\ttitle: '订单消息',\r\n\t\t\t\t\tmessage: '订单添加成功，请立即前往订单记录页面支付订单',\r\n\t\t\t\t\ttype: 'success'\r\n\t\t\t\t});\r\n\t\t\t\tthis.$router.push('blog')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\ti {\r\n\t\tfont-size: 16px;\r\n\t}\r\n\r\n\t.float-bar {\r\n\t\tposition: relative;\r\n\t\theight: 72px;\r\n\t\tborder-top: 1px solid #e6e6e6;\r\n\t\tborder-radius: 5px;\r\n\t}\r\n\r\n\t.float-bar-wrapper {\r\n\t\theight: 72px;\r\n\t\toverflow: hidden;\r\n\t\tmargin: 0 20px;\r\n\t}\r\n\r\n\t.float-bar-right {\r\n\t\tfloat: right;\r\n\t\tposition: absolute;\r\n\t\tright: 18px;\r\n\t\ttop: 15px;\r\n\t\tz-index: 4;\r\n\t\tpadding-left: 20px;\r\n\t}\r\n\r\n\t.amount_items {\r\n\t\tcursor: pointer;\r\n\t\theight: 48px;\r\n\t\tcolor: #3c3c3c;\r\n\t\tfloat: left;\r\n\t\tletter-spacing: 1px;\r\n\t\tmargin-right: 30px;\r\n\t}\r\n\r\n\t.amount_items span {\r\n\t\tfloat: left;\r\n\t\tline-height: 48px;\r\n\t\tfont-size: 20px;\r\n\t\tcolor: #000;\r\n\t}\r\n\r\n\t.price_sum {\r\n\t\tmargin-right: 7px;\r\n\t\theight: 48px;\r\n\t\tcolor: #3c3c3c;\r\n\t\tfloat: left;\r\n\t\tfont-style: normal;\r\n\t}\r\n\r\n\t.total {\r\n\t\tline-height: 48px;\r\n\t\tfont-size: 20px;\r\n\t\tcolor: #000;\r\n\t}\r\n\r\n\t.price-sum .price {\r\n\t\tcolor: #f40;\r\n\t\tfont-weight: 400;\r\n\t\tfont-size: 18px;\r\n\t\tline-height: 48px;\r\n\t\tfont-family: Arial;\r\n\t\tvertical-align: middle;\r\n\t\tfloat: left;\r\n\t}\r\n\r\n\t.total-symbol {\r\n\t\tfont-size: 14px;\r\n\t\tfont-family: verdana;\r\n\t\tfont-weight: 400;\r\n\t}\r\n\r\n\t.sub-button {\r\n\t\ttext-align: center;\r\n\t\twidth: 94px;\r\n\t\theight: 42px;\r\n\t\tline-height: 42px;\r\n\t\tcolor: #fff;\r\n\t\tbackground: #FF5000;\r\n\t\tborder-radius: 21px;\r\n\t\tfont-size: 16px;\r\n\t\tcursor: pointer;\r\n\t\tborder: none;\r\n\t}\r\n</style>\n"]}]}